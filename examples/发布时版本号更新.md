# 发布时版本号更新方法

## 问题：Git working directory not clean

当运行 `npm version patch` 时，如果 Git 工作目录有未提交的更改，会出现此错误。

## 解决方案

### 方案一：提交更改后更新版本（推荐）

```bash
# 1. 提交所有更改
git add .
git commit -m "准备发布新版本"

# 2. 更新版本号（会自动创建 commit 和 tag）
npm version patch
```

### 方案二：跳过 Git 操作更新版本

如果你不想自动创建 git commit 和 tag：

```bash
# 使用 --no-git-tag-version 标志
npm version patch --no-git-tag-version
```

### 方案三：手动更新版本号

直接编辑 `package.json` 中的 `version` 字段：

```json
{
  "version": "7.3.9"  // 手动修改
}
```

然后发布：

```bash
npm publish
```

## 推荐流程

```bash
# 1. 确保代码已构建
npm run build

# 2. 提交更改（如果需要）
git add .
git commit -m "更新构建文件"

# 3. 更新版本号
npm version patch  # 或 minor, major

# 4. 发布
npm publish

# 5. 推送 git tag（如果需要）
git push --tags
```

## 版本号说明

- **patch** (7.3.8 → 7.3.9): 补丁版本，bug 修复
- **minor** (7.3.8 → 7.4.0): 小版本，新功能
- **major** (7.3.8 → 8.0.0): 大版本，破坏性更改

